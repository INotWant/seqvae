batch_size=32,z_size=64,seq_len=20,emb_dim=64,vocab_size=5000,hidden_dim=32,dropout_keep_prob=0.75,free_bits=0,encoder_learning_rate=0.01,enc_rnn_size=[32, 32],residual_encoder=True,dencoder_learning_rate=0.01,compute_rewards_step=1,dec_update_rate=0.8,rollout_num=16,dis_learning_rate=0.0001,dis_train_freq=5,dis_filter_sizes=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20],dis_num_filters=[100, 200, 200, 200, 200, 100, 100, 100, 100, 100, 160, 160]
Start pre-training...
pre-train epoch  0 kl_loss:  1.1474073 r_loss:  7.7532387 nll:  9.782013
pre-train epoch  5 kl_loss:  0.035813123 r_loss:  6.8260813 nll:  9.020469
pre-train epoch  10 kl_loss:  0.051333606 r_loss:  6.4406104 nll:  8.894863
pre-train epoch  15 kl_loss:  0.05396498 r_loss:  6.2562075 nll:  8.849852
pre-train epoch  20 kl_loss:  0.0336411 r_loss:  6.1454887 nll:  8.814502
pre-train epoch  25 kl_loss:  0.019111851 r_loss:  6.0710397 nll:  8.80731
pre-train epoch  30 kl_loss:  0.0165319 r_loss:  6.0305967 nll:  8.791204
pre-train epoch  35 kl_loss:  0.041494723 r_loss:  5.9963565 nll:  8.773379
Start pre-training discriminator...
#########################################################################
Start Training...
epoch:  0 kl_loss:  0.10162592 pg_loss:  87.33392 nll:  8.785324
epoch:  1 kl_loss:  0.15481007 pg_loss:  250.71323 nll:  8.771389
epoch:  2 kl_loss:  0.30018294 pg_loss:  26.562828 nll:  8.768416
epoch:  3 kl_loss:  0.1714381 pg_loss:  58.694553 nll:  8.748812
epoch:  4 kl_loss:  0.16786216 pg_loss:  73.57104 nll:  8.732463
epoch:  5 kl_loss:  0.24701354 pg_loss:  168.12224 nll:  8.738609
epoch:  6 kl_loss:  0.32854235 pg_loss:  51.052258 nll:  8.717847
epoch:  7 kl_loss:  0.34706593 pg_loss:  156.96594 nll:  8.709685
epoch:  8 kl_loss:  0.2873807 pg_loss:  32.841415 nll:  8.698875
epoch:  9 kl_loss:  0.1833314 pg_loss:  10.435123 nll:  8.6860695
epoch:  10 kl_loss:  0.10768704 pg_loss:  30.231434 nll:  8.685511
epoch:  11 kl_loss:  0.094619945 pg_loss:  24.633747 nll:  8.67897
epoch:  12 kl_loss:  0.13294788 pg_loss:  16.270369 nll:  8.670883
epoch:  13 kl_loss:  0.18688053 pg_loss:  19.52654 nll:  8.65375
epoch:  14 kl_loss:  0.20366573 pg_loss:  323.6863 nll:  8.633923
epoch:  15 kl_loss:  0.16893694 pg_loss:  22.097937 nll:  8.625203
epoch:  16 kl_loss:  0.11136182 pg_loss:  24.786839 nll:  8.625499
epoch:  17 kl_loss:  0.06685884 pg_loss:  88.03418 nll:  8.626441
epoch:  18 kl_loss:  0.055910308 pg_loss:  17.127127 nll:  8.611776
epoch:  19 kl_loss:  0.070434906 pg_loss:  14.693595 nll:  8.604604
epoch:  20 kl_loss:  0.08843452 pg_loss:  13.170262 nll:  8.603152
epoch:  21 kl_loss:  0.09218083 pg_loss:  20.212034 nll:  8.581629
epoch:  22 kl_loss:  0.07620966 pg_loss:  27.310822 nll:  8.5743265
epoch:  23 kl_loss:  0.05539833 pg_loss:  16.157581 nll:  8.580984
epoch:  24 kl_loss:  0.039197534 pg_loss:  30.386925 nll:  8.557986
epoch:  25 kl_loss:  0.035767686 pg_loss:  7.2744923 nll:  8.579461
epoch:  26 kl_loss:  0.040290233 pg_loss:  17.04043 nll:  8.541955
epoch:  27 kl_loss:  0.044839367 pg_loss:  45.904026 nll:  8.559655
epoch:  28 kl_loss:  0.043537684 pg_loss:  10.158636 nll:  8.541819
epoch:  29 kl_loss:  0.03677412 pg_loss:  21.050344 nll:  8.538259
epoch:  30 kl_loss:  0.029928766 pg_loss:  0.46736646 nll:  8.527996
epoch:  31 kl_loss:  0.02652055 pg_loss:  6.8135467 nll:  8.522275
epoch:  32 kl_loss:  0.025413245 pg_loss:  18.123592 nll:  8.532263
epoch:  33 kl_loss:  0.026731879 pg_loss:  0.98047996 nll:  8.5217085
epoch:  34 kl_loss:  0.028977126 pg_loss:  1.492351 nll:  8.51686
epoch:  35 kl_loss:  0.028772503 pg_loss:  1.6975064 nll:  8.524793
epoch:  36 kl_loss:  0.025276542 pg_loss:  12.546598 nll:  8.506812
epoch:  37 kl_loss:  0.019966602 pg_loss:  4.992243 nll:  8.51966
epoch:  38 kl_loss:  0.015279837 pg_loss:  51.05715 nll:  8.490336
epoch:  39 kl_loss:  0.012812674 pg_loss:  2.6032252 nll:  8.503067
epoch:  40 kl_loss:  0.012411699 pg_loss:  8.439727 nll:  8.50154
epoch:  41 kl_loss:  0.012841068 pg_loss:  0.76564837 nll:  8.501411
epoch:  42 kl_loss:  0.01276052 pg_loss:  22.767641 nll:  8.490569
epoch:  43 kl_loss:  0.01173595 pg_loss:  0.2806092 nll:  8.472911
epoch:  44 kl_loss:  0.009956431 pg_loss:  0.28400803 nll:  8.479001
epoch:  45 kl_loss:  0.008074103 pg_loss:  9.299161 nll:  8.475917
epoch:  46 kl_loss:  0.0066679604 pg_loss:  7.2508693 nll:  8.472964
epoch:  47 kl_loss:  0.0059983656 pg_loss:  1.8412476 nll:  8.470205
epoch:  48 kl_loss:  0.0058901906 pg_loss:  4.703993 nll:  8.463975
epoch:  49 kl_loss:  0.008079752 pg_loss:  14.959298 nll:  8.466459
epoch:  50 kl_loss:  0.01289919 pg_loss:  4.3567686 nll:  8.435059
epoch:  51 kl_loss:  0.015810907 pg_loss:  7.830982 nll:  8.453103
epoch:  52 kl_loss:  0.014554203 pg_loss:  12.371313 nll:  8.448029
epoch:  53 kl_loss:  0.010163896 pg_loss:  0.36828613 nll:  8.4492235
epoch:  54 kl_loss:  0.005575192 pg_loss:  1.8315837 nll:  8.437947
epoch:  55 kl_loss:  0.0032702982 pg_loss:  62.517487 nll:  8.454901
epoch:  56 kl_loss:  0.003969185 pg_loss:  14.698201 nll:  8.452817
epoch:  57 kl_loss:  0.0059906393 pg_loss:  18.225935 nll:  8.431631
epoch:  58 kl_loss:  0.0074322224 pg_loss:  3.672352 nll:  8.443596
epoch:  59 kl_loss:  0.0075106025 pg_loss:  2.0235326 nll:  8.446359
epoch:  60 kl_loss:  0.0059471503 pg_loss:  1.6271453 nll:  8.441592
epoch:  61 kl_loss:  0.003844738 pg_loss:  0.4070338 nll:  8.44157
epoch:  62 kl_loss:  0.002417732 pg_loss:  2.6141644 nll:  8.42542
epoch:  63 kl_loss:  0.0024697445 pg_loss:  6.6418777 nll:  8.438597
epoch:  64 kl_loss:  0.0034748614 pg_loss:  18.116566 nll:  8.44653
epoch:  65 kl_loss:  0.0042941347 pg_loss:  3.5733013 nll:  8.449427
epoch:  66 kl_loss:  0.00420624 pg_loss:  3.004828 nll:  8.447233
epoch:  67 kl_loss:  0.0032276586 pg_loss:  4.618371 nll:  8.433116
epoch:  68 kl_loss:  0.0020484366 pg_loss:  13.833273 nll:  8.437988
epoch:  69 kl_loss:  0.004133716 pg_loss:  0.72847867 nll:  8.437334
epoch:  70 kl_loss:  0.010633826 pg_loss:  6.7091517 nll:  8.438304
epoch:  71 kl_loss:  0.017934036 pg_loss:  5.2162795 nll:  8.442793
epoch:  72 kl_loss:  0.01719714 pg_loss:  1.348189 nll:  8.445813
epoch:  73 kl_loss:  0.017385885 pg_loss:  8.086036 nll:  8.429769
epoch:  74 kl_loss:  0.016932711 pg_loss:  2.7910054 nll:  8.435316
epoch:  75 kl_loss:  0.015153468 pg_loss:  1.1724205 nll:  8.430403
epoch:  76 kl_loss:  0.012710243 pg_loss:  5.2598486 nll:  8.421385
epoch:  77 kl_loss:  0.010420471 pg_loss:  16.237223 nll:  8.436958
epoch:  78 kl_loss:  0.008987263 pg_loss:  0.1315613 nll:  8.42077
epoch:  79 kl_loss:  0.008352462 pg_loss:  20.866034 nll:  8.419616
epoch:  80 kl_loss:  0.022404104 pg_loss:  8.827499 nll:  8.430368
epoch:  81 kl_loss:  0.051934004 pg_loss:  18.279238 nll:  8.419344
epoch:  82 kl_loss:  0.07120851 pg_loss:  0.003312487 nll:  8.419987
epoch:  83 kl_loss:  0.06703958 pg_loss:  0.13089928 nll:  8.408804
epoch:  84 kl_loss:  0.0446108 pg_loss:  1.0225383 nll:  8.414732
epoch:  85 kl_loss:  0.02020377 pg_loss:  0.4758327 nll:  8.403387
epoch:  86 kl_loss:  0.008058757 pg_loss:  10.857347 nll:  8.4197
epoch:  87 kl_loss:  0.010840852 pg_loss:  4.0119214 nll:  8.421941
epoch:  88 kl_loss:  0.01685626 pg_loss:  5.6979604 nll:  8.415615
epoch:  89 kl_loss:  0.020508409 pg_loss:  1.0254045 nll:  8.42192
epoch:  90 kl_loss:  0.0191212 pg_loss:  18.503815 nll:  8.402927
epoch:  91 kl_loss:  0.024503827 pg_loss:  5.572531 nll:  8.419182
epoch:  92 kl_loss:  0.042060435 pg_loss:  0.68384093 nll:  8.412663
epoch:  93 kl_loss:  0.053592235 pg_loss:  107.16198 nll:  8.420122
epoch:  94 kl_loss:  0.04888469 pg_loss:  4.209713 nll:  8.420431
epoch:  95 kl_loss:  0.03198272 pg_loss:  1.6310674 nll:  8.404103
epoch:  96 kl_loss:  0.015379615 pg_loss:  0.5654283 nll:  8.420988
epoch:  97 kl_loss:  0.009130448 pg_loss:  6.610799 nll:  8.411174
epoch:  98 kl_loss:  0.013993859 pg_loss:  0.5908389 nll:  8.421403
epoch:  99 kl_loss:  0.022210568 pg_loss:  3.59348 nll:  8.432415
epoch:  100 kl_loss:  0.02548325 pg_loss:  4.7169456 nll:  8.425612
epoch:  101 kl_loss:  0.021120608 pg_loss:  5.105695 nll:  8.41248
epoch:  102 kl_loss:  0.013201222 pg_loss:  6.542599 nll:  8.424925
epoch:  103 kl_loss:  0.006917678 pg_loss:  7.491594 nll:  8.4293165
epoch:  104 kl_loss:  0.005610168 pg_loss:  0.080150336 nll:  8.410891
epoch:  105 kl_loss:  0.00818412 pg_loss:  13.606278 nll:  8.432717
epoch:  106 kl_loss:  0.011120945 pg_loss:  6.405361 nll:  8.415925
epoch:  107 kl_loss:  0.011625528 pg_loss:  14.334438 nll:  8.423972
epoch:  108 kl_loss:  0.0094100535 pg_loss:  2.1117582 nll:  8.421416
epoch:  109 kl_loss:  0.006204203 pg_loss:  1.2052737 nll:  8.415215
epoch:  110 kl_loss:  0.004001148 pg_loss:  6.2420177 nll:  8.429949
epoch:  111 kl_loss:  0.0037292615 pg_loss:  117.130936 nll:  8.425774
epoch:  112 kl_loss:  0.004625216 pg_loss:  0.0001628486 nll:  8.417891
epoch:  113 kl_loss:  0.0053727627 pg_loss:  4.930021 nll:  8.423527
epoch:  114 kl_loss:  0.005230069 pg_loss:  3.502927 nll:  8.415826
epoch:  115 kl_loss:  0.0042513013 pg_loss:  3.5456562 nll:  8.444304
epoch:  116 kl_loss:  0.0036010146 pg_loss:  52.552578 nll:  8.407947
epoch:  117 kl_loss:  0.0033378676 pg_loss:  2.634058 nll:  8.421501
epoch:  118 kl_loss:  0.0031758174 pg_loss:  17.330256 nll:  8.426277
epoch:  119 kl_loss:  0.003293775 pg_loss:  2.7242892 nll:  8.414583
epoch:  120 kl_loss:  0.0033027232 pg_loss:  321.41196 nll:  8.414325
epoch:  121 kl_loss:  0.0030465797 pg_loss:  13.846261 nll:  8.435901
epoch:  122 kl_loss:  0.002600491 pg_loss:  4.5578074 nll:  8.423759
epoch:  123 kl_loss:  0.002305571 pg_loss:  3.7785904 nll:  8.421641
epoch:  124 kl_loss:  0.0020903945 pg_loss:  3.1413193 nll:  8.430896
epoch:  125 kl_loss:  0.0019450039 pg_loss:  3.633924 nll:  8.419835
epoch:  126 kl_loss:  0.0017919317 pg_loss:  14.953732 nll:  8.435806
epoch:  127 kl_loss:  0.0015889443 pg_loss:  19.116125 nll:  8.428848
epoch:  128 kl_loss:  0.0014113411 pg_loss:  5.270425 nll:  8.44098
epoch:  129 kl_loss:  0.001263475 pg_loss:  0.09442771 nll:  8.436946
epoch:  130 kl_loss:  0.0011593029 pg_loss:  0.04316534 nll:  8.442934
epoch:  131 kl_loss:  0.0010628887 pg_loss:  17.156467 nll:  8.454658
epoch:  132 kl_loss:  0.0010324325 pg_loss:  5.6414423 nll:  8.45392
epoch:  133 kl_loss:  0.0010987967 pg_loss:  6.962112 nll:  8.46321
epoch:  134 kl_loss:  0.03492877 pg_loss:  9.290765 nll:  8.449997
epoch:  135 kl_loss:  0.09920961 pg_loss:  4.906922 nll:  8.444072
epoch:  136 kl_loss:  0.13553804 pg_loss:  4.1915693 nll:  8.457811
epoch:  137 kl_loss:  0.11851004 pg_loss:  39.039474 nll:  8.467767
epoch:  138 kl_loss:  0.06629819 pg_loss:  13.9927225 nll:  8.468984
epoch:  139 kl_loss:  0.01831317 pg_loss:  0.011189775 nll:  8.469307
epoch:  140 kl_loss:  0.0033461843 pg_loss:  5.40277 nll:  8.4612255
epoch:  141 kl_loss:  0.021000773 pg_loss:  1.0911348 nll:  8.461341
epoch:  142 kl_loss:  0.04828441 pg_loss:  1.1236275 nll:  8.465667
epoch:  143 kl_loss:  0.060921997 pg_loss:  0.8793386 nll:  8.484006
epoch:  144 kl_loss:  0.05070366 pg_loss:  1.4128321 nll:  8.463276
epoch:  145 kl_loss:  0.028511688 pg_loss:  4.595293 nll:  8.476938
epoch:  146 kl_loss:  0.010336099 pg_loss:  6.1738667 nll:  8.480605
epoch:  147 kl_loss:  0.0061615556 pg_loss:  12.620547 nll:  8.469307
epoch:  148 kl_loss:  0.014644146 pg_loss:  1.9410012 nll:  8.47621
epoch:  149 kl_loss:  0.025547087 pg_loss:  7.2075796 nll:  8.476279
epoch:  150 kl_loss:  0.029243827 pg_loss:  60.915905 nll:  8.472409
epoch:  151 kl_loss:  0.023677379 pg_loss:  5.503395 nll:  8.482557
epoch:  152 kl_loss:  0.013855442 pg_loss:  2.0977845 nll:  8.477192
epoch:  153 kl_loss:  0.006500911 pg_loss:  3.0249074 nll:  8.482403
epoch:  154 kl_loss:  0.0057732984 pg_loss:  14.48361 nll:  8.478683
epoch:  155 kl_loss:  0.010077789 pg_loss:  2.4740455 nll:  8.468825
epoch:  156 kl_loss:  0.0142039955 pg_loss:  0.57376784 nll:  8.47959
epoch:  157 kl_loss:  0.014594719 pg_loss:  92.38837 nll:  8.480462
epoch:  158 kl_loss:  0.011259109 pg_loss:  3.6332688 nll:  8.498063
epoch:  159 kl_loss:  0.006893389 pg_loss:  8.348973 nll:  8.488161
epoch:  160 kl_loss:  0.0039816815 pg_loss:  9.440396 nll:  8.4913225
epoch:  161 kl_loss:  0.0038253032 pg_loss:  0.040820234 nll:  8.474768
epoch:  162 kl_loss:  0.0053404123 pg_loss:  161.85521 nll:  8.482665
epoch:  163 kl_loss:  0.006718263 pg_loss:  1.1419817 nll:  8.483545
epoch:  164 kl_loss:  0.006658554 pg_loss:  3.5397933 nll:  8.503027
epoch:  165 kl_loss:  0.007179722 pg_loss:  2.4315517 nll:  8.491647
epoch:  166 kl_loss:  0.007533148 pg_loss:  20.35561 nll:  8.475788
epoch:  167 kl_loss:  0.0069817007 pg_loss:  2.332802 nll:  8.497282
epoch:  168 kl_loss:  0.0055475608 pg_loss:  7.463798 nll:  8.492684
epoch:  169 kl_loss:  0.003940191 pg_loss:  6.871484 nll:  8.501302
epoch:  170 kl_loss:  0.0031022578 pg_loss:  1.5654101 nll:  8.487978
epoch:  171 kl_loss:  0.0032105297 pg_loss:  13.06617 nll:  8.486831
epoch:  172 kl_loss:  0.0036855638 pg_loss:  38.522255 nll:  8.480339
epoch:  173 kl_loss:  0.0039363503 pg_loss:  0.299832 nll:  8.487852
epoch:  174 kl_loss:  0.0035612434 pg_loss:  4.1730623 nll:  8.498622
epoch:  175 kl_loss:  0.0026900247 pg_loss:  4.860391 nll:  8.496082
epoch:  176 kl_loss:  0.0018051267 pg_loss:  0.2976999 nll:  8.485375
epoch:  177 kl_loss:  0.0013876036 pg_loss:  6.011594 nll:  8.492002
epoch:  178 kl_loss:  0.0016780794 pg_loss:  6.27069 nll:  8.479051
epoch:  179 kl_loss:  0.002257079 pg_loss:  4.5734167 nll:  8.499971
epoch:  180 kl_loss:  0.0025326163 pg_loss:  5.9021997 nll:  8.505686
epoch:  181 kl_loss:  0.010392398 pg_loss:  2.2950234 nll:  8.48843
epoch:  182 kl_loss:  0.0235205 pg_loss:  3.6944025 nll:  8.486906
epoch:  183 kl_loss:  0.029761791 pg_loss:  497.61823 nll:  8.500243
epoch:  184 kl_loss:  0.027979344 pg_loss:  21.678068 nll:  8.5017
epoch:  185 kl_loss:  0.025534287 pg_loss:  1.3353338 nll:  8.501149
epoch:  186 kl_loss:  0.021712184 pg_loss:  15.992369 nll:  8.485771
epoch:  187 kl_loss:  0.017966703 pg_loss:  8.310131 nll:  8.497388
epoch:  188 kl_loss:  0.015381694 pg_loss:  3.3111804 nll:  8.495429
epoch:  189 kl_loss:  0.014103487 pg_loss:  0.52533126 nll:  8.49041
epoch:  190 kl_loss:  0.013438761 pg_loss:  4.0650344 nll:  8.483657
epoch:  191 kl_loss:  0.01259695 pg_loss:  11.735779 nll:  8.499198
epoch:  192 kl_loss:  0.011669368 pg_loss:  0.39941415 nll:  8.490689
epoch:  193 kl_loss:  0.010594346 pg_loss:  4.7091484 nll:  8.495317
epoch:  194 kl_loss:  0.0133211315 pg_loss:  3.3478386 nll:  8.483826
epoch:  195 kl_loss:  0.01667042 pg_loss:  17.361818 nll:  8.491061
epoch:  196 kl_loss:  0.017144054 pg_loss:  12.175919 nll:  8.4751835
epoch:  197 kl_loss:  0.03102763 pg_loss:  2.6771424 nll:  8.497336
epoch:  198 kl_loss:  0.04937476 pg_loss:  11.466936 nll:  8.490663
epoch:  199 kl_loss:  0.054096624 pg_loss:  2.0307972 nll:  8.496829
