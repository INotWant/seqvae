batch_size=32,z_size=64,seq_len=20,emb_dim=64,vocab_size=5000,hidden_dim=32,dropout_keep_prob=0.75,free_bits=0,encoder_learning_rate=0.01,enc_rnn_size=[32, 32],residual_encoder=True,dencoder_learning_rate=0.01,compute_rewards_step=1,dec_update_rate=0.8,rollout_num=16,dis_learning_rate=0.0001,dis_train_freq=5,dis_filter_sizes=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20],dis_num_filters=[100, 200, 200, 200, 200, 100, 100, 100, 100, 100, 160, 160]
Start pre-training...
pre-train epoch  0 kl_loss:  0.78682494 r_loss:  7.7654433 nll:  9.795097
pre-train epoch  5 kl_loss:  0.33871025 r_loss:  6.8382254 nll:  9.046512
pre-train epoch  10 kl_loss:  0.01979768 r_loss:  6.459607 nll:  8.8962345
pre-train epoch  15 kl_loss:  0.050706815 r_loss:  6.2778087 nll:  8.851408
pre-train epoch  20 kl_loss:  0.012417135 r_loss:  6.1715345 nll:  8.826569
pre-train epoch  25 kl_loss:  0.024021601 r_loss:  6.104164 nll:  8.824008
pre-train epoch  30 kl_loss:  0.03393713 r_loss:  6.0592604 nll:  8.821802
pre-train epoch  35 kl_loss:  0.0064382516 r_loss:  6.0189285 nll:  8.794108
Start pre-training discriminator...
#########################################################################
Start Training...
epoch:  0 kl_loss:  0.0076702703 pg_loss:  19.001263 nll:  8.809689
epoch:  1 kl_loss:  0.1192524 pg_loss:  17.88221 nll:  8.81536
epoch:  2 kl_loss:  0.2464618 pg_loss:  10.020165 nll:  8.807547
epoch:  3 kl_loss:  0.116632104 pg_loss:  20.429985 nll:  8.80476
epoch:  4 kl_loss:  0.11895214 pg_loss:  4.1888514 nll:  8.804755
epoch:  5 kl_loss:  0.1978836 pg_loss:  2.680537 nll:  8.807981
epoch:  6 kl_loss:  0.24537608 pg_loss:  9.629275 nll:  8.806067
epoch:  7 kl_loss:  0.212397 pg_loss:  14.413077 nll:  8.800958
epoch:  8 kl_loss:  0.14487481 pg_loss:  3.8691905 nll:  8.790407
epoch:  9 kl_loss:  0.12517321 pg_loss:  4.1253147 nll:  8.775713
epoch:  10 kl_loss:  0.14223051 pg_loss:  2.7083032 nll:  8.784495
epoch:  11 kl_loss:  0.1656022 pg_loss:  7.8585963 nll:  8.76489
epoch:  12 kl_loss:  0.16379197 pg_loss:  4.7931967 nll:  8.760274
epoch:  13 kl_loss:  0.14346129 pg_loss:  2.6098585 nll:  8.754316
epoch:  14 kl_loss:  0.12524843 pg_loss:  2.02172 nll:  8.754092
epoch:  15 kl_loss:  0.117495716 pg_loss:  0.9880376 nll:  8.748127
epoch:  16 kl_loss:  0.11375332 pg_loss:  2.2048607 nll:  8.730354
epoch:  17 kl_loss:  0.10264605 pg_loss:  4.25103 nll:  8.746809
epoch:  18 kl_loss:  0.08495659 pg_loss:  3.4103887 nll:  8.722494
epoch:  19 kl_loss:  0.07932609 pg_loss:  3.3330357 nll:  8.730629
epoch:  20 kl_loss:  0.08748895 pg_loss:  1.8569692 nll:  8.707312
epoch:  21 kl_loss:  0.09150389 pg_loss:  2.0539782 nll:  8.714952
epoch:  22 kl_loss:  0.08013663 pg_loss:  0.8666914 nll:  8.709767
epoch:  23 kl_loss:  0.060244262 pg_loss:  0.92282975 nll:  8.706751
epoch:  24 kl_loss:  0.044962715 pg_loss:  0.7661484 nll:  8.699092
epoch:  25 kl_loss:  0.04201749 pg_loss:  0.8256108 nll:  8.702998
epoch:  26 kl_loss:  0.047241032 pg_loss:  1.5605352 nll:  8.68219
epoch:  27 kl_loss:  0.0507795 pg_loss:  4.0936437 nll:  8.690021
epoch:  28 kl_loss:  0.04868129 pg_loss:  1.0524911 nll:  8.686439
epoch:  29 kl_loss:  0.04040143 pg_loss:  1.3046668 nll:  8.695261
epoch:  30 kl_loss:  0.03500177 pg_loss:  0.99548465 nll:  8.689564
epoch:  31 kl_loss:  0.04044985 pg_loss:  7.5365114 nll:  8.681201
epoch:  32 kl_loss:  0.046955302 pg_loss:  8.054448 nll:  8.684804
epoch:  33 kl_loss:  0.045311816 pg_loss:  1.4852109 nll:  8.672696
epoch:  34 kl_loss:  0.036963344 pg_loss:  1.7218883 nll:  8.674246
epoch:  35 kl_loss:  0.029231265 pg_loss:  1.0407809 nll:  8.67126
epoch:  36 kl_loss:  0.024784058 pg_loss:  4.6896563 nll:  8.661689
epoch:  37 kl_loss:  0.039653108 pg_loss:  2.5620105 nll:  8.666827
epoch:  38 kl_loss:  0.0596206 pg_loss:  0.082290724 nll:  8.655568
epoch:  39 kl_loss:  0.06276613 pg_loss:  1.406347 nll:  8.650734
epoch:  40 kl_loss:  0.045884714 pg_loss:  2.360512 nll:  8.647289
epoch:  41 kl_loss:  0.02594249 pg_loss:  1.4064944 nll:  8.6554365
epoch:  42 kl_loss:  0.022203628 pg_loss:  0.86296797 nll:  8.644005
epoch:  43 kl_loss:  0.03025277 pg_loss:  5.319155 nll:  8.636543
epoch:  44 kl_loss:  0.03698431 pg_loss:  1.2310894 nll:  8.637732
epoch:  45 kl_loss:  0.03470902 pg_loss:  24.933685 nll:  8.641806
epoch:  46 kl_loss:  0.023702214 pg_loss:  2.1441007 nll:  8.618459
epoch:  47 kl_loss:  0.018764473 pg_loss:  0.58530074 nll:  8.643833
epoch:  48 kl_loss:  0.020852618 pg_loss:  1.0771397 nll:  8.632259
epoch:  49 kl_loss:  0.024233535 pg_loss:  0.7259774 nll:  8.615373
epoch:  50 kl_loss:  0.024000691 pg_loss:  1.1789702 nll:  8.6100645
epoch:  51 kl_loss:  0.019487776 pg_loss:  0.39657682 nll:  8.613194
epoch:  52 kl_loss:  0.0533566 pg_loss:  1.5517918 nll:  8.611845
epoch:  53 kl_loss:  0.113539144 pg_loss:  1.6234542 nll:  8.612136
epoch:  54 kl_loss:  0.13831644 pg_loss:  0.9286307 nll:  8.607993
epoch:  55 kl_loss:  0.10865426 pg_loss:  0.2988186 nll:  8.604378
epoch:  56 kl_loss:  0.054396056 pg_loss:  3.1309793 nll:  8.609739
epoch:  57 kl_loss:  0.018492267 pg_loss:  0.932046 nll:  8.606963
epoch:  58 kl_loss:  0.019476175 pg_loss:  0.46193272 nll:  8.597923
epoch:  59 kl_loss:  0.04235211 pg_loss:  0.44203147 nll:  8.5955
epoch:  60 kl_loss:  0.05916328 pg_loss:  0.4128749 nll:  8.595517
epoch:  61 kl_loss:  0.05509249 pg_loss:  2.1981022 nll:  8.606616
epoch:  62 kl_loss:  0.03642389 pg_loss:  1.0348047 nll:  8.594764
epoch:  63 kl_loss:  0.019443393 pg_loss:  3.7939868 nll:  8.606312
epoch:  64 kl_loss:  0.015100515 pg_loss:  0.25305334 nll:  8.589938
epoch:  65 kl_loss:  0.02038602 pg_loss:  0.5312899 nll:  8.593642
epoch:  66 kl_loss:  0.026142746 pg_loss:  1.4627924 nll:  8.591424
epoch:  67 kl_loss:  0.026007384 pg_loss:  0.009362895 nll:  8.589238
epoch:  68 kl_loss:  0.020889608 pg_loss:  2.312352 nll:  8.602812
epoch:  69 kl_loss:  0.01513274 pg_loss:  0.18375507 nll:  8.598636
epoch:  70 kl_loss:  0.011863612 pg_loss:  2.4366257 nll:  8.586929
epoch:  71 kl_loss:  0.011086509 pg_loss:  1.9206408 nll:  8.595368
epoch:  72 kl_loss:  0.011112027 pg_loss:  2.2004817 nll:  8.575609
epoch:  73 kl_loss:  0.010629714 pg_loss:  0.23428379 nll:  8.585865
epoch:  74 kl_loss:  0.0095905885 pg_loss:  1.4347479 nll:  8.573856
epoch:  75 kl_loss:  0.0085074175 pg_loss:  0.41856837 nll:  8.592264
epoch:  76 kl_loss:  0.007645134 pg_loss:  8.308418 nll:  8.57865
epoch:  77 kl_loss:  0.0077192 pg_loss:  1.0613428 nll:  8.589799
epoch:  78 kl_loss:  0.008543651 pg_loss:  0.7397004 nll:  8.586562
epoch:  79 kl_loss:  0.008521512 pg_loss:  0.4583988 nll:  8.588377
epoch:  80 kl_loss:  0.0071960073 pg_loss:  1.0590591 nll:  8.581094
epoch:  81 kl_loss:  0.005377028 pg_loss:  0.4510171 nll:  8.585512
epoch:  82 kl_loss:  0.0041838028 pg_loss:  6.3604617 nll:  8.580998
epoch:  83 kl_loss:  0.0040028915 pg_loss:  0.9612742 nll:  8.57704
epoch:  84 kl_loss:  0.004367456 pg_loss:  0.018769553 nll:  8.581289
epoch:  85 kl_loss:  0.0044852933 pg_loss:  0.0006836953 nll:  8.581116
epoch:  86 kl_loss:  0.0039399695 pg_loss:  0.30477327 nll:  8.580422
epoch:  87 kl_loss:  0.0029821456 pg_loss:  0.18747146 nll:  8.583303
epoch:  88 kl_loss:  0.0021872902 pg_loss:  0.15840451 nll:  8.573857
epoch:  89 kl_loss:  0.0019630366 pg_loss:  0.3624184 nll:  8.568142
epoch:  90 kl_loss:  0.0022251932 pg_loss:  1.6388712 nll:  8.566417
epoch:  91 kl_loss:  0.0024716575 pg_loss:  1.8868847 nll:  8.5777235
epoch:  92 kl_loss:  0.0022959206 pg_loss:  4.33262 nll:  8.588141
epoch:  93 kl_loss:  0.0017405865 pg_loss:  0.625895 nll:  8.574877
epoch:  94 kl_loss:  0.0013921779 pg_loss:  2.7379694 nll:  8.570461
epoch:  95 kl_loss:  0.0012718914 pg_loss:  2.1762893 nll:  8.562151
epoch:  96 kl_loss:  0.001326398 pg_loss:  0.97216034 nll:  8.569407
epoch:  97 kl_loss:  0.0013050223 pg_loss:  0.5798694 nll:  8.571849
epoch:  98 kl_loss:  0.0011486355 pg_loss:  1.218971 nll:  8.574379
epoch:  99 kl_loss:  0.040318146 pg_loss:  0.0813895 nll:  8.573787
epoch:  100 kl_loss:  0.11133369 pg_loss:  0.081685625 nll:  8.566582
epoch:  101 kl_loss:  0.14388913 pg_loss:  1.7079642 nll:  8.576906
epoch:  102 kl_loss:  0.11322333 pg_loss:  0.7259858 nll:  8.5623455
epoch:  103 kl_loss:  0.053746156 pg_loss:  5.249889 nll:  8.566406
epoch:  104 kl_loss:  0.013096111 pg_loss:  0.0002811703 nll:  8.55635
epoch:  105 kl_loss:  0.013024807 pg_loss:  29.294628 nll:  8.5706835
epoch:  106 kl_loss:  0.039164595 pg_loss:  16.691898 nll:  8.549526
epoch:  107 kl_loss:  0.06143581 pg_loss:  2.0717158 nll:  8.562131
epoch:  108 kl_loss:  0.06073934 pg_loss:  1.0303346 nll:  8.55104
epoch:  109 kl_loss:  0.04107271 pg_loss:  0.49419045 nll:  8.543372
epoch:  110 kl_loss:  0.02012048 pg_loss:  2.0064807 nll:  8.552706
epoch:  111 kl_loss:  0.011542112 pg_loss:  0.1365015 nll:  8.54894
epoch:  112 kl_loss:  0.01565132 pg_loss:  0.6088567 nll:  8.549604
epoch:  113 kl_loss:  0.023632899 pg_loss:  0.96382946 nll:  8.545399
epoch:  114 kl_loss:  0.026907206 pg_loss:  4.035662 nll:  8.549789
epoch:  115 kl_loss:  0.022959977 pg_loss:  1.2521957 nll:  8.547457
epoch:  116 kl_loss:  0.016780093 pg_loss:  0.9533656 nll:  8.5400715
epoch:  117 kl_loss:  0.011992071 pg_loss:  0.88799334 nll:  8.545012
epoch:  118 kl_loss:  0.010214951 pg_loss:  0.021743655 nll:  8.544202
epoch:  119 kl_loss:  0.010425642 pg_loss:  0.806442 nll:  8.5496025
epoch:  120 kl_loss:  0.011166334 pg_loss:  0.32082316 nll:  8.534225
epoch:  121 kl_loss:  0.011316903 pg_loss:  5.6874094e-05 nll:  8.542393
epoch:  122 kl_loss:  0.010433104 pg_loss:  0.14867198 nll:  8.543176
epoch:  123 kl_loss:  0.008898929 pg_loss:  0.1383418 nll:  8.538571
epoch:  124 kl_loss:  0.0073134024 pg_loss:  0.23713496 nll:  8.532676
epoch:  125 kl_loss:  0.0061411485 pg_loss:  1.2628628 nll:  8.542143
epoch:  126 kl_loss:  0.0054246243 pg_loss:  0.089769326 nll:  8.54138
epoch:  127 kl_loss:  0.005033875 pg_loss:  1.106499 nll:  8.545049
epoch:  128 kl_loss:  0.0047780895 pg_loss:  1.4636372 nll:  8.531863
epoch:  129 kl_loss:  0.004562389 pg_loss:  0.33512896 nll:  8.547908
epoch:  130 kl_loss:  0.0043296125 pg_loss:  0.39336583 nll:  8.537825
epoch:  131 kl_loss:  0.003926862 pg_loss:  1.5267885 nll:  8.542016
epoch:  132 kl_loss:  0.0033788923 pg_loss:  1.4871762 nll:  8.51986
epoch:  133 kl_loss:  0.0028192755 pg_loss:  1.0134612 nll:  8.525769
epoch:  134 kl_loss:  0.0023722192 pg_loss:  0.94610566 nll:  8.542419
epoch:  135 kl_loss:  0.0020838492 pg_loss:  1.7956223 nll:  8.534937
epoch:  136 kl_loss:  0.0019480843 pg_loss:  1.436761 nll:  8.536815
epoch:  137 kl_loss:  0.0018819273 pg_loss:  2.4567652 nll:  8.540332
epoch:  138 kl_loss:  0.0017908515 pg_loss:  1.2708693 nll:  8.545674
epoch:  139 kl_loss:  0.0016156118 pg_loss:  0.8322235 nll:  8.527168
epoch:  140 kl_loss:  0.0013756198 pg_loss:  0.717359 nll:  8.531436
epoch:  141 kl_loss:  0.0011251885 pg_loss:  0.6134715 nll:  8.536656
epoch:  142 kl_loss:  0.00097250566 pg_loss:  0.82606506 nll:  8.537465
epoch:  143 kl_loss:  0.0010433419 pg_loss:  1.318881 nll:  8.530269
epoch:  144 kl_loss:  0.001242226 pg_loss:  2.4300387 nll:  8.540099
epoch:  145 kl_loss:  0.0013436475 pg_loss:  1.4769964 nll:  8.549293
epoch:  146 kl_loss:  0.0011945246 pg_loss:  1.3959082 nll:  8.529719
epoch:  147 kl_loss:  0.0025251657 pg_loss:  0.25429147 nll:  8.545869
epoch:  148 kl_loss:  0.005450342 pg_loss:  0.8312762 nll:  8.547754
epoch:  149 kl_loss:  0.0072116256 pg_loss:  0.027458224 nll:  8.55998
epoch:  150 kl_loss:  0.00660868 pg_loss:  0.14298089 nll:  8.54294
epoch:  151 kl_loss:  0.004350677 pg_loss:  10.34868 nll:  8.554048
epoch:  152 kl_loss:  0.0023366772 pg_loss:  1.3360465 nll:  8.557151
epoch:  153 kl_loss:  0.002821112 pg_loss:  0.24191378 nll:  8.5619545
epoch:  154 kl_loss:  0.0052747545 pg_loss:  0.8569362 nll:  8.555949
epoch:  155 kl_loss:  0.006938696 pg_loss:  0.13091397 nll:  8.543589
epoch:  156 kl_loss:  0.0064134 pg_loss:  1.3321598 nll:  8.552312
epoch:  157 kl_loss:  0.004254667 pg_loss:  1.6914163 nll:  8.568545
epoch:  158 kl_loss:  0.0022426767 pg_loss:  5.363516 nll:  8.565331
epoch:  159 kl_loss:  0.0014450755 pg_loss:  1.8316582 nll:  8.575498
epoch:  160 kl_loss:  0.0018339753 pg_loss:  12.135382 nll:  8.564319
epoch:  161 kl_loss:  0.0026452914 pg_loss:  0.11184469 nll:  8.5678425
epoch:  162 kl_loss:  0.0030977072 pg_loss:  2.02397 nll:  8.576283
epoch:  163 kl_loss:  0.0029154774 pg_loss:  2.7273936 nll:  8.584523
epoch:  164 kl_loss:  0.002219852 pg_loss:  0.034801435 nll:  8.568813
epoch:  165 kl_loss:  0.0013724118 pg_loss:  4.486244 nll:  8.58052
epoch:  166 kl_loss:  0.0030234382 pg_loss:  0.22576874 nll:  8.565655
epoch:  167 kl_loss:  0.007576689 pg_loss:  1.0649825 nll:  8.569233
epoch:  168 kl_loss:  0.022220325 pg_loss:  2.8546412 nll:  8.5715065
epoch:  169 kl_loss:  0.04279592 pg_loss:  1.5597752 nll:  8.572324
epoch:  170 kl_loss:  0.048762426 pg_loss:  0.18204613 nll:  8.572427
epoch:  171 kl_loss:  0.037018426 pg_loss:  0.3362042 nll:  8.578402
epoch:  172 kl_loss:  0.018851023 pg_loss:  7.48407 nll:  8.571636
epoch:  173 kl_loss:  0.007774093 pg_loss:  0.4451327 nll:  8.573416
epoch:  174 kl_loss:  0.008355215 pg_loss:  0.80538243 nll:  8.564904
epoch:  175 kl_loss:  0.015318196 pg_loss:  0.6122039 nll:  8.575743
epoch:  176 kl_loss:  0.0204072 pg_loss:  1.0150505 nll:  8.563952
epoch:  177 kl_loss:  0.019514866 pg_loss:  0.12964538 nll:  8.57176
epoch:  178 kl_loss:  0.014136493 pg_loss:  40.063084 nll:  8.564756
epoch:  179 kl_loss:  0.020666972 pg_loss:  1.2723502 nll:  8.572255
epoch:  180 kl_loss:  0.03542831 pg_loss:  0.80220205 nll:  8.567812
epoch:  181 kl_loss:  0.041276306 pg_loss:  1.111589 nll:  8.564956
epoch:  182 kl_loss:  0.034891058 pg_loss:  1.7044841 nll:  8.563316
epoch:  183 kl_loss:  0.023130558 pg_loss:  0.20662905 nll:  8.5773115
epoch:  184 kl_loss:  0.017372001 pg_loss:  0.08085618 nll:  8.566748
epoch:  185 kl_loss:  0.018833071 pg_loss:  0.06018386 nll:  8.559146
epoch:  186 kl_loss:  0.022984639 pg_loss:  0.35825276 nll:  8.567263
epoch:  187 kl_loss:  0.02375468 pg_loss:  0.13355342 nll:  8.575613
epoch:  188 kl_loss:  0.019370232 pg_loss:  0.4672979 nll:  8.574358
epoch:  189 kl_loss:  0.012191366 pg_loss:  1.4748122 nll:  8.577133
epoch:  190 kl_loss:  0.0096719 pg_loss:  0.2854894 nll:  8.572996
epoch:  191 kl_loss:  0.012780413 pg_loss:  26.310774 nll:  8.567824
epoch:  192 kl_loss:  0.016273191 pg_loss:  5.7512403 nll:  8.566927
epoch:  193 kl_loss:  0.016143858 pg_loss:  22.716925 nll:  8.562673
epoch:  194 kl_loss:  0.012343489 pg_loss:  0.00074529735 nll:  8.567948
epoch:  195 kl_loss:  0.0078358725 pg_loss:  0.70650816 nll:  8.573718
epoch:  196 kl_loss:  0.005389007 pg_loss:  1.1153423 nll:  8.567204
epoch:  197 kl_loss:  0.0058176704 pg_loss:  19.658731 nll:  8.57466
epoch:  198 kl_loss:  0.0074453056 pg_loss:  2.5028136 nll:  8.577128
epoch:  199 kl_loss:  0.008180093 pg_loss:  0.4936664 nll:  8.562744
