/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From sequence_gan.py:18: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From sequence_gan.py:96: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From sequence_gan.py:98: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-12-19 21:42:04.606737: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-12-19 21:42:04.620205: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.620633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:01:00.0
2020-12-19 21:42:04.620759: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-12-19 21:42:04.622019: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-12-19 21:42:04.623037: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-12-19 21:42:04.623200: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-12-19 21:42:04.624308: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-12-19 21:42:04.624928: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-12-19 21:42:04.627350: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-12-19 21:42:04.627427: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.628004: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.628394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-12-19 21:42:04.628585: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-12-19 21:42:04.649790: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3699850000 Hz
2020-12-19 21:42:04.650288: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5565303149d0 executing computations on platform Host. Devices:
2020-12-19 21:42:04.650332: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-12-19 21:42:04.650552: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.651108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:01:00.0
2020-12-19 21:42:04.651135: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-12-19 21:42:04.651146: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-12-19 21:42:04.651157: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-12-19 21:42:04.651167: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-12-19 21:42:04.651178: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-12-19 21:42:04.651188: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-12-19 21:42:04.651203: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-12-19 21:42:04.651240: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.651832: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.652220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-12-19 21:42:04.652242: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-12-19 21:42:04.774801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-19 21:42:04.774827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-12-19 21:42:04.774832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-12-19 21:42:04.774957: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.775321: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.775655: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-12-19 21:42:04.776049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10250 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-12-19 21:42:04.777130: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556533cb0d70 executing computations on platform CUDA. Devices:
2020-12-19 21:42:04.777141: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
WARNING:tensorflow:From ../target_lstm.py:21: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From ../target_lstm.py:23: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From ../target_lstm.py:52: multinomial (from tensorflow.python.ops.random_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.random.categorical` instead.
WARNING:tensorflow:From ../target_lstm.py:97: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From ../seqgan/generator.py:209: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From ../seqgan/discriminator.py:95: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /home/gaoting/anaconda3/envs/tmp/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From ../seqgan/discriminator.py:114: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From ../seqgan/discriminator.py:122: The name tf.nn.xw_plus_b is deprecated. Please use tf.compat.v1.nn.xw_plus_b instead.

WARNING:tensorflow:From ../seqgan/discriminator.py:128: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

2020-12-19 21:42:06.693500: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
2020-12-19 21:42:07.560679: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-12-19 22:11:54.336515: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
Start pre-training...
pre-train epoch  0 test_loss  9.791137
pre-train epoch  5 test_loss  8.666003
pre-train epoch  10 test_loss  8.517778
pre-train epoch  15 test_loss  8.463181
pre-train epoch  20 test_loss  8.436887
pre-train epoch  25 test_loss  8.431765
pre-train epoch  30 test_loss  8.40761
pre-train epoch  35 test_loss  8.410826
pre-train epoch  40 test_loss  8.41239
pre-train epoch  45 test_loss  8.427587
pre-train epoch  50 test_loss  8.422695
pre-train epoch  55 test_loss  8.419998
pre-train epoch  60 test_loss  8.423652
pre-train epoch  65 test_loss  8.419951
pre-train epoch  70 test_loss  8.412213
pre-train epoch  75 test_loss  8.411
pre-train epoch  80 test_loss  8.41719
pre-train epoch  85 test_loss  8.412038
pre-train epoch  90 test_loss  8.433436
pre-train epoch  95 test_loss  8.415403
pre-train epoch  100 test_loss  8.416832
pre-train epoch  105 test_loss  8.415889
pre-train epoch  110 test_loss  8.419913
pre-train epoch  115 test_loss  8.437576
Start pre-training discriminator...
#########################################################################
Start Adversarial Training...
epoch:  0 nll:  8.388288
epoch:  1 nll:  8.488996
epoch:  2 nll:  8.339719
epoch:  3 nll:  8.378909
epoch:  4 nll:  8.416095
epoch:  5 nll:  8.351147
epoch:  6 nll:  8.3917
epoch:  7 nll:  8.389824
epoch:  8 nll:  8.36991
epoch:  9 nll:  8.386489
epoch:  10 nll:  8.371844
epoch:  11 nll:  8.373687
epoch:  12 nll:  8.330071
epoch:  13 nll:  8.30961
epoch:  14 nll:  8.358015
epoch:  15 nll:  8.392932
epoch:  16 nll:  8.331992
epoch:  17 nll:  8.361716
epoch:  18 nll:  8.380425
epoch:  19 nll:  8.332263
epoch:  20 nll:  8.416841
epoch:  21 nll:  8.420106
epoch:  22 nll:  8.413428
epoch:  23 nll:  8.370368
epoch:  24 nll:  8.353154
epoch:  25 nll:  8.4336405
epoch:  26 nll:  8.278801
epoch:  27 nll:  8.344674
epoch:  28 nll:  8.366882
epoch:  29 nll:  8.399749
epoch:  30 nll:  8.356538
epoch:  31 nll:  8.409167
epoch:  32 nll:  8.292701
epoch:  33 nll:  8.351244
epoch:  34 nll:  8.319314
epoch:  35 nll:  8.322442
epoch:  36 nll:  8.401057
epoch:  37 nll:  8.366226
epoch:  38 nll:  8.354602
epoch:  39 nll:  8.364699
epoch:  40 nll:  8.353944
epoch:  41 nll:  8.390716
epoch:  42 nll:  8.37933
epoch:  43 nll:  8.363258
epoch:  44 nll:  8.397846
epoch:  45 nll:  8.320191
epoch:  46 nll:  8.397522
epoch:  47 nll:  8.421118
epoch:  48 nll:  8.392526
epoch:  49 nll:  8.405986
epoch:  50 nll:  8.413476
epoch:  51 nll:  8.354479
epoch:  52 nll:  8.379228
epoch:  53 nll:  8.360757
epoch:  54 nll:  8.370067
epoch:  55 nll:  8.403386
epoch:  56 nll:  8.34504
epoch:  57 nll:  8.367638
epoch:  58 nll:  8.351871
epoch:  59 nll:  8.400279
epoch:  60 nll:  8.357047
epoch:  61 nll:  8.37329
epoch:  62 nll:  8.399456
epoch:  63 nll:  8.365111
epoch:  64 nll:  8.400352
epoch:  65 nll:  8.30333
epoch:  66 nll:  8.398474
epoch:  67 nll:  8.378098
epoch:  68 nll:  8.417792
epoch:  69 nll:  8.41717
epoch:  70 nll:  8.370246
epoch:  71 nll:  8.374366
epoch:  72 nll:  8.362283
epoch:  73 nll:  8.302133
epoch:  74 nll:  8.352187
epoch:  75 nll:  8.334336
epoch:  76 nll:  8.324258
epoch:  77 nll:  8.335151
epoch:  78 nll:  8.360291
epoch:  79 nll:  8.389298
epoch:  80 nll:  8.334348
epoch:  81 nll:  8.342244
epoch:  82 nll:  8.4254265
epoch:  83 nll:  8.358435
epoch:  84 nll:  8.313638
epoch:  85 nll:  8.349027
epoch:  86 nll:  8.322162
epoch:  87 nll:  8.349441
epoch:  88 nll:  8.362584
epoch:  89 nll:  8.423751
epoch:  90 nll:  8.346337
epoch:  91 nll:  8.374902
epoch:  92 nll:  8.303157
epoch:  93 nll:  8.360993
epoch:  94 nll:  8.291497
epoch:  95 nll:  8.353662
epoch:  96 nll:  8.316087
epoch:  97 nll:  8.440294
epoch:  98 nll:  8.373105
epoch:  99 nll:  8.267558
epoch:  100 nll:  8.371587
epoch:  101 nll:  8.415287
epoch:  102 nll:  8.359216
epoch:  103 nll:  8.336464
epoch:  104 nll:  8.340856
epoch:  105 nll:  8.397205
epoch:  106 nll:  8.322402
epoch:  107 nll:  8.348805
epoch:  108 nll:  8.395573
epoch:  109 nll:  8.363841
epoch:  110 nll:  8.380722
epoch:  111 nll:  8.41658
epoch:  112 nll:  8.405511
epoch:  113 nll:  8.434391
epoch:  114 nll:  8.437793
epoch:  115 nll:  8.362047
epoch:  116 nll:  8.468907
epoch:  117 nll:  8.396559
epoch:  118 nll:  8.382878
epoch:  119 nll:  8.4153
epoch:  120 nll:  8.425982
epoch:  121 nll:  8.422595
epoch:  122 nll:  8.358033
epoch:  123 nll:  8.430588
epoch:  124 nll:  8.372797
epoch:  125 nll:  8.42212
epoch:  126 nll:  8.449571
epoch:  127 nll:  8.373534
epoch:  128 nll:  8.408383
epoch:  129 nll:  8.46972
epoch:  130 nll:  8.407553
epoch:  131 nll:  8.331907
epoch:  132 nll:  8.38374
epoch:  133 nll:  8.393804
epoch:  134 nll:  8.384292
epoch:  135 nll:  8.456468
epoch:  136 nll:  8.406926
epoch:  137 nll:  8.443093
epoch:  138 nll:  8.428212
epoch:  139 nll:  8.367953
epoch:  140 nll:  8.500817
epoch:  141 nll:  8.462028
epoch:  142 nll:  8.415334
epoch:  143 nll:  8.35135
epoch:  144 nll:  8.428472
epoch:  145 nll:  8.4005575
epoch:  146 nll:  8.455215
epoch:  147 nll:  8.437312
epoch:  148 nll:  8.458973
epoch:  149 nll:  8.512674
